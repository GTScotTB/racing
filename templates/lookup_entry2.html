<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Look Up Entry</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <header>
    <h1>Look Up Entry</h1>
  </header>

  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  <div class="messages">
    {% for category, message in messages %}
    <div class="alert {{ category }}">{{ message }}</div>
    {% endfor %}
  </div>
  {% endif %}
  {% endwith %}

  <!-- Search Form -->
  <form action="/lookup_entry2" method="GET">
    <label for="search_query">Search:</label>
    <input type="text" id="search_query" name="search_query" placeholder="Driver name, vehicle number, etc." required>
    <button type="submit">Search</button>
  </form>

<!-- Results Section -->
{% if results %}
<h2>Search Results</h2>
<table border="1">
  <thead>
    <tr>
      <th>Driver Name</th>
      <th>Vehicle Number</th>
      <th>Make</th>
      <th>Model</th>
      <th>Class</th>
      <th>Garage Number</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for entry in results %}
    <tr>
      <td>{{ entry.driver_name }}</td>
      <td>{{ entry.vehicle_number }}</td>
      <td>{{ entry.vehicle_make }}</td>
      <td>{{ entry.vehicle_model }}</td>
      <td>{{ entry.class_type }}</td>
      <td>{{ entry.garage_number or "Not Assigned" }}</td>
      <td>
        <form action="/view_checklist2" method="POST" style="display:inline;">
    <!-- CSRF token for security -->
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
          <input type="hidden" name="entry_id" value="{{ entry.id }}">
          <button type="submit">Select</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% elif search_query %}
<p>No results found for "{{ search_query }}".</p>
<a href="/add_entry">
  <button type="button">Add Entry</button>
</a>
{% endif %}

  <!-- Button to return to Home -->
  <button onclick="window.location.href='/'">Back to Home</button>
</body>
</html>